---
description: detecting basic OS Command Injection vulnerabilities
---

# Exploitation

## Detection

* If the command output changes from the intended usual result, we have successfully exploited the vulnerability

### Command Injection Methods

To inject an additional command to the intended one, we may use any of the following operators:

<table data-header-hidden><thead><tr><th width="139"></th><th width="112"></th><th width="143"></th><th></th></tr></thead><tbody><tr><td><strong>Injection Operator</strong></td><td><strong>Injection Character</strong></td><td><strong>URL-Encoded Character</strong></td><td><strong>Executed Command</strong></td></tr><tr><td>Semicolon</td><td><code>;</code></td><td><code>%3b</code></td><td>Both (not work in cmd)</td></tr><tr><td>New Line</td><td><code>\n</code></td><td><code>%0a</code></td><td>Both</td></tr><tr><td>Background</td><td><code>&#x26;</code></td><td><code>%26</code></td><td>Both (second output generally shown first)</td></tr><tr><td>Pipe</td><td><code>|</code></td><td><code>%7c</code></td><td>Both (only second output is shown)</td></tr><tr><td>AND</td><td><code>&#x26;&#x26;</code></td><td><code>%26%26</code></td><td>Both (only if first succeeds)</td></tr><tr><td>OR</td><td><code>||</code></td><td><code>%7c%7c</code></td><td>Second (only if first fails)</td></tr><tr><td>Sub-Shell</td><td><code>``</code></td><td><code>%60%60</code></td><td>Both (Linux-only)</td></tr><tr><td>Sub-Shell</td><td><code>$()</code></td><td><code>%24%28%29</code></td><td>Both (Linux-only)</td></tr></tbody></table>

Use above operators so `both` or `either` of the commands get executed.

## Injecting Commands

### ;

```bash
ping -c 1 127.0.0.1; whoami
```

### &&

```bash
ping -c 1 127.0.0.1 && whoami
```

### ||

```bash
ping -c 1 127.0.0.1 || whoami
```

> whoami only executes if ping breaks.

### Most common operators that can be used for injections:

<table data-header-hidden><thead><tr><th width="341"></th><th></th></tr></thead><tbody><tr><td><strong>Injection Type</strong></td><td><strong>Operators</strong></td></tr><tr><td>SQL Injection</td><td><code>'</code> <code>,</code> <code>;</code> <code>--</code> <code>/* */</code></td></tr><tr><td>Command Injection</td><td><code>;</code> <code>&#x26;&#x26;</code></td></tr><tr><td>LDAP Injection</td><td><code>*</code> <code>(</code> <code>)</code> <code>&#x26;</code> <code>|</code></td></tr><tr><td>XPath Injection</td><td><code>'</code> <code>or</code> <code>and</code> <code>not</code> <code>substring</code> <code>concat</code> <code>count</code></td></tr><tr><td>OS Command Injection</td><td><code>;</code> <code>&#x26;</code> <code>|</code></td></tr><tr><td>Code Injection</td><td><code>'</code> <code>;</code> <code>--</code> <code>/* */</code> <code>$()</code> <code>${}</code> <code>#{}</code> <code>%{}</code> <code>^</code></td></tr><tr><td>Directory Traversal/File Path Traversal</td><td><code>../</code> <code>..\\</code> <code>%00</code></td></tr><tr><td>Object Injection</td><td><code>;</code> <code>&#x26;</code> <code>|</code></td></tr><tr><td>XQuery Injection</td><td><code>'</code> <code>;</code> <code>--</code> <code>/* */</code></td></tr><tr><td>Shellcode Injection</td><td><code>\x</code> <code>\u</code> <code>%u</code> <code>%n</code></td></tr><tr><td>Header Injection</td><td> <code>\r</code>  <code>%0d</code> <code>%0a</code> <code>%09</code></td></tr></tbody></table>

















